#!/bin/sh

main_session=$USER

tmux start-server
tmux has-session -t $main_session 2>/dev/null

if [ $? -eq 1 ] ; then
    cd $HOME/.dotfiles
    tmux new-session -s $main_session -n vim~zsh -d

    tmux send-keys -t $main_session 'edf' C-m
    tmux splitw -t $main_session -h -p 50
    tmux selectp -t $main_session -t 1

    tmux selectw -t $main_session -t 1

    tmux a -t $main_session
else
    session_name=`tmux display -p '#{session_name}'`
    in_tmux=`echo $TMUX`

    if [ "$in_tmux" != "" ] || [ $session_name != $main_session ] ; then
        tmux detach-client
    fi
fi
